options(scipen = 1, digits = 4, width = 80, fig.align = "center")
disease = read.csv("Disease Data.csv")
library(lmtest)
str(disease)
fitted_vs_resid = function(model) {
plot(fitted(model), resid(model),
col = "grey", pch = 20,
xlab = "Fitted Value",
ylab = "Residual",
main = "Fitted Value versus Residual")
abline(h = 0, lwd = 3, col = "dodgerblue")
}
qqplot = function(model) {
qqnorm(resid(model), col = "grey", lwd = 3)
qqline(resid(model), col = "dodgerblue", cex = 1.5, pch = 20)
}
calc_loocv_rmse = function(model) {
sqrt(mean((resid(model) / (1 - hatvalues(model))) ^ 2))
}
disease = subset(disease, select = - X)
library(faraway)
vif(disease)
vif(disease)[which(vif(disease) > 5)]
fit_full_add = lm(Disease.Severity ~ ., data = disease)
n = nrow(disease)
p = length(coef(fit_full_add))
cook_full_add = cooks.distance(fit_full_add)
outlier_full_add = which(cook_full_add > 4 / n)
cook_full_add[outlier_full_add]
fit_full_add = lm(Disease.Severity ~ ., data = disease[-outlier_full_add,])
fit_full_log_add = lm(log(Disease.Severity) ~ ., data = disease)
fit_bic_log_add = step(fit_full_log_add, direction = "backward", k = log(n), trace = 0)
cook_bic_log = cooks.distance(fit_bic_log_add)
outlier_log_add = which(cook_bic_log > 4 / n)
cook_bic_log[outlier_full_add]
fit_full_log_add = lm(log(Disease.Severity) ~ ., data = disease[-outlier_log_add, ])
fit_bic_log_add = step(fit_full_log_add, direction = "backward", trace = 0, k = log(n))
library(MASS)
boxcox(fit_full_add, plotit = TRUE, lambda = seq(-0.5, 0, by = 0.05))
fit_boxcox = lm(((Disease.Severity^(-0.25) - 1) / (-0.25)) ~ ., data = disease)
fit_bic_boxcox = step(fit_boxcox, direction = "backward", trace = 0, k = log(n))
fit_boxcox = lm(((Disease.Severity^(-0.25) - 1) / (-0.25)) ~ ., data = disease[-F2R,])
fit_boxcox = lm(((Disease.Severity^(-0.25) - 1) / (-0.25)) ~ ., data = subset(disease, select = -"F2R"))
fit_boxcox = lm(((Disease.Severity^(-0.25) - 1) / (-0.25)) ~ ., data = subset(disease, select = -F2R))
fit_bic_boxcox = step(fit_boxcox, direction = "backward", trace = 0, k = log(n))
summary(fit_bic_boxcox)
cook_boxcox = cooks.distance(fit_bic_boxcox)
outlier_boxcox = which(cook_boxcox > 4 / n)
cook_boxcox[outlier_boxcox]
fit_boxcox = lm(((Disease.Severity^(-0.25) - 1) / (-0.25)) ~ ., data = subset(disease[-outlier_boxcox,], select = -F2R))
fit_bic_boxcox = step(fit_boxcox, direction = "backward", trace = 0, k = log(n))
summary(fit_bic_boxcox)
fitted_vs_resid(fit_bic_boxcox)
qqplot(fit_bic_boxcox)
bptest(fit_bic_boxcox)
shapiro.test(resid(fit_bic_boxcox))
disease = read.csv("Disease Data.csv")
library(lmtest)
?diesase
summary(disease)
disease = read.csv("Disease Data.csv")
library(zoo)
library(lmtest)
disease = read.csv("Disease Data.csv")
library(lmtest)
library(faraway)
library(MASS)
str(disease)
disease = subset(disease, select = - X)
summary(disease)
pairs(disease)
correlation_within = cor(disease)
abs(correlation_within) > 0.5
abs(correlation_within) > 0.9
correlation_within = cor(disease)
abs(correlation_within) > 0.9
vif(disease)
vif(disease)[which(vif(disease) > 5)]
options(scipen = 1, digits = 4, width = 80, fig.align = "center")
disease = read.csv("Disease Data.csv")
library(lmtest)
library(faraway)
library(MASS)
library(leaps)
fitted_vs_resid = function(model) {
plot(fitted(model), resid(model),
col = "grey", pch = 20,
xlab = "Fitted Value",
ylab = "Residual",
main = "Fitted Value versus Residual")
abline(h = 0, lwd = 3, col = "dodgerblue")
}
qqplot = function(model) {
qqnorm(resid(model), col = "grey", lwd = 3)
qqline(resid(model), col = "dodgerblue", cex = 1.5, pch = 20)
}
calc_loocv_rmse = function(model) {
sqrt(mean((resid(model) / (1 - hatvalues(model))) ^ 2))
}
str(disease)
disease = subset(disease, select = - X)
correlation_within = cor(disease)
which(abs(correlation_within) > 0.9)
correlation_within = cor(disease)
abs(correlation_within) > 0.9
fit_full_add = lm(Disease.Severity ~ ., data = disease)
glance(fit_full_add)
summary(fit_full_add)
summary(fit_full_add)
View(fit_full_add)
fitted_vs_resid(fit_full_add)
qqplot(fit_full_add)
n = nrow(disease)
p = length(coef(fit_full_add))
cook_full_add = cooks.distance(fit_full_add)
outlier_full_add = which(cook_full_add > 4 / n)
cook_full_add[outlier_full_add]
fit_full_add = lm(Disease.Severity ~ ., data = disease[-outlier_full_add,])
fitted_vs_resid(fit_full_add)
qqplot(fit_full_add)
fitted_vs_resid(fit_aic_add)
fit_aic_add = step(fit_full_add, direction = "both", trace = 0)
fitted_vs_resid(fit_aic_add)
qqplot(fit_aic_add)
fit_bic_add = step(fit_full_add, direction = "backward", trace = 0, k = log(n))
fitted_vs_resid(fit_aic_add)
qqplot(fit_aic_add)
summary(fit_aic_add)
fit_full_log_add = lm(log(Disease.Severity) ~ ., data = disease)
summary(fit_full_log_add)
fit_bic_log_add = step(fit_full_log_add, direction = "backward", k = log(n), trace = 0)
summary(fit_bic_log_add)
summary(fit_bic_log_add)
fitted_vs_resid(fit_bic_log_add)
qqplot(fit_bic_log_add)
cook_bic_log = cooks.distance(fit_bic_log_add)
outlier_log_add = which(cook_bic_log > 4 / n)
cook_bic_log[outlier_full_add]
fitted_vs_resid(fit_bic_log_add)
qqplot(fit_bic_log_add)
fit_full_log_add = lm(log(Disease.Severity) ~ ., data = disease[-outlier_log_add, ])
fit_bic_log_add = step(fit_full_log_add, direction = "backward", trace = 0, k = log(n))
summary(fit_bic_log_add)
fitted_vs_resid(fit_bic_log_add)
qqplot(fit_bic_log_add)
bptest(fit_bic_log_add)
shapiro.test(resid(fit_bic_log_add))
fit_full_log_int = lm(log(Disease.Severity) ~ . ^ 2, data = disease[-outlier_log_add, ])
fit_bic_log_int = step(fit_full_log_int, direction = "backward", k = log(n), trace = 0)
summary(fit_bic_log_int)
fitted_vs_resid(fit_bic_log_int)
qqplot(fit_bic_log_int)
bptest(fit_bic_log_int)
shapiro.test(resid(fit_bic_log_int))
anova(fit_bic_log_add, fit_bic_log_int)
length(coef(fit_bic_log_int))
cook_bic_log_int = cooks.distance(fit_bic_log_int)
outlier_log_int = which(cook_bic_log_int > 4 / n)
fit_full_log_int = lm(log(Disease.Severity) ~ . ^ 2, data = disease[-outlier_log_int,])
fit_bic_log_int = step(fit_full_log_int, direction = "backward", k = log(n), trace = 0)
length(coef(fit_bic_log_int))
fitted_vs_resid(fit_bic_log_int)
qqplot(fit_bic_log_int)
bptest(fit_bic_log_int)
shapiro.test(resid(fit_bic_log_int))
boxcox(fit_full_add, plotit = TRUE, lambda = seq(-0.5, 0, by = 0.05))
boxcox(fit_aic_add, plotit = TRUE, lambda = seq(-0.5, 0, by = 0.05))
boxcox(fit_bic_add, plotit = TRUE, lambda = seq(-0.5, 0, by = 0.05))
boxcox(fit_full_add, plotit = TRUE, lambda = seq(-0.5, 0, by = 0.05))
fit_boxcox = lm(((Disease.Severity^(-0.25) - 1) / (-0.25)) ~ ., data = disease)
fit_bic_boxcox = step(fit_boxcox, direction = "backward", trace = 0, k = log(n))
cook_boxcox = cooks.distance(fit_bic_boxcox)
outlier_boxcox = which(cook_boxcox > 4 / n)
cook_boxcox[outlier_boxcox]
fit_boxcox = lm(((Disease.Severity^(-0.25) - 1) / (-0.25)) ~ ., data = disease[-outlier_boxcox,])
fit_bic_boxcox = step(fit_boxcox, direction = "backward", trace = 0, k = log(n))
summary(fit_bic_boxcox)
cook_boxcox = cooks.distance(fit_bic_boxcox)
outlier_boxcox = which(cook_boxcox > 4 / n)
fit_boxcox = lm(((Disease.Severity^(-0.25) - 1) / (-0.25)) ~ ., data = disease[-outlier_boxcox,])
fit_bic_boxcox = step(fit_boxcox, direction = "backward", trace = 0, k = log(n))
summary(fit_bic_boxcox)
fitted_vs_resid(fit_bic_boxcox)
qqplot(fit_bic_boxcox)
bptest(fit_bic_boxcox)
shapiro.test(resid(fit_bic_boxcox))
boxcox(fit_full_add, plotit = TRUE, lambda = seq(-0.5, 0, by = 0.05))
fit_boxcox = lm(((Disease.Severity^(-0.25) - 1) / (-0.25)) ~ ., data = disease)
fit_bic_boxcox = step(fit_boxcox, direction = "backward", trace = 0, k = log(n))
cook_boxcox = cooks.distance(fit_bic_boxcox)
outlier_boxcox = which(cook_boxcox > 4 / n)
cook_boxcox = cooks.distance(fit_bic_boxcox)
outlier_boxcox = which(cook_boxcox > 4 / n)
fit_boxcox = lm(((Disease.Severity^(-0.25) - 1) / (-0.25)) ~ ., data = disease[-outlier_boxcox,])
fit_bic_boxcox = step(fit_boxcox, direction = "backward", trace = 0, k = log(n))
summary(fit_bic_boxcox)
fitted_vs_resid(fit_bic_boxcox)
qqplot(fit_bic_boxcox)
bptest(fit_bic_boxcox)
shapiro.test(resid(fit_bic_boxcox))
devtools::install_github("rstudio/rmarkdown")
install.packages("devtools")
devtools::install_github("rstudio/rmarkdown")
