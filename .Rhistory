options(scipen = 1, digits = 4, width = 80, fig.align = "center")
disease = read.csv("Disease Data.csv")
library(lmtest)
str(disease)
fitted_vs_resid = function(model) {
plot(fitted(model), resid(model),
col = "grey", pch = 20,
xlab = "Fitted Value",
ylab = "Residual",
main = "Fitted Value versus Residual")
abline(h = 0, lwd = 3, col = "dodgerblue")
}
qqplot = function(model) {
qqnorm(resid(model), col = "grey", lwd = 3)
qqline(resid(model), col = "dodgerblue", cex = 1.5, pch = 20)
}
calc_loocv_rmse = function(model) {
sqrt(mean((resid(model) / (1 - hatvalues(model))) ^ 2))
}
disease = subset(disease, select = - X)
library(faraway)
vif(disease)
vif(disease)[which(vif(disease) > 5)]
fit_full_add = lm(Disease.Severity ~ ., data = disease)
n = nrow(disease)
p = length(coef(fit_full_add))
cook_full_add = cooks.distance(fit_full_add)
outlier_full_add = which(cook_full_add > 4 / n)
cook_full_add[outlier_full_add]
fit_full_add = lm(Disease.Severity ~ ., data = disease[-outlier_full_add,])
fit_full_log_add = lm(log(Disease.Severity) ~ ., data = disease)
fit_bic_log_add = step(fit_full_log_add, direction = "backward", k = log(n), trace = 0)
cook_bic_log = cooks.distance(fit_bic_log_add)
outlier_log_add = which(cook_bic_log > 4 / n)
cook_bic_log[outlier_full_add]
fit_full_log_add = lm(log(Disease.Severity) ~ ., data = disease[-outlier_log_add, ])
fit_bic_log_add = step(fit_full_log_add, direction = "backward", trace = 0, k = log(n))
library(MASS)
boxcox(fit_full_add, plotit = TRUE, lambda = seq(-0.5, 0, by = 0.05))
fit_boxcox = lm(((Disease.Severity^(-0.25) - 1) / (-0.25)) ~ ., data = disease)
fit_bic_boxcox = step(fit_boxcox, direction = "backward", trace = 0, k = log(n))
fit_boxcox = lm(((Disease.Severity^(-0.25) - 1) / (-0.25)) ~ ., data = disease[-F2R,])
fit_boxcox = lm(((Disease.Severity^(-0.25) - 1) / (-0.25)) ~ ., data = subset(disease, select = -"F2R"))
fit_boxcox = lm(((Disease.Severity^(-0.25) - 1) / (-0.25)) ~ ., data = subset(disease, select = -F2R))
fit_bic_boxcox = step(fit_boxcox, direction = "backward", trace = 0, k = log(n))
summary(fit_bic_boxcox)
cook_boxcox = cooks.distance(fit_bic_boxcox)
outlier_boxcox = which(cook_boxcox > 4 / n)
cook_boxcox[outlier_boxcox]
fit_boxcox = lm(((Disease.Severity^(-0.25) - 1) / (-0.25)) ~ ., data = subset(disease[-outlier_boxcox,], select = -F2R))
fit_bic_boxcox = step(fit_boxcox, direction = "backward", trace = 0, k = log(n))
summary(fit_bic_boxcox)
fitted_vs_resid(fit_bic_boxcox)
qqplot(fit_bic_boxcox)
bptest(fit_bic_boxcox)
shapiro.test(resid(fit_bic_boxcox))
disease = read.csv("Disease Data.csv")
library(lmtest)
?diesase
summary(disease)
disease = read.csv("Disease Data.csv")
library(zoo)
library(lmtest)
disease = read.csv("Disease Data.csv")
library(lmtest)
library(faraway)
library(MASS)
str(disease)
disease = subset(disease, select = - X)
summary(disease)
pairs(disease)
correlation_within = cor(disease)
abs(correlation_within) > 0.5
abs(correlation_within) > 0.9
correlation_within = cor(disease)
abs(correlation_within) > 0.9
vif(disease)
vif(disease)[which(vif(disease) > 5)]
